module.exports=[55683,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(38246),e=a.i(50944),f=a.i(210),g=a.i(15618),h=a.i(21161),i=a.i(60246),j=a.i(53722);let k=(0,a.i(70106).default)("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);var l=a.i(81560),m=a.i(84581),n=a.i(96438),o=a.i(21920),p=a.i(84668),q=a.i(49741),r=a.i(49140),s=a.i(14512);function t({episode:a,project:c,handleDeleteEpisode:e}){let{attributes:f,listeners:g,setNodeRef:h,transform:i,transition:j}=(0,r.useSortable)({id:a.id}),o={transform:s.CSS.Transform.toString(i),transition:j};return(0,b.jsxs)("div",{ref:h,style:o,className:"group bg-[#111] border border-zinc-900 hover:border-zinc-700 rounded-xl p-5 flex items-center justify-between transition-all",children:[(0,b.jsxs)("div",{className:"flex-1 flex items-center gap-4",children:[(0,b.jsx)("div",{...f,...g,className:"text-zinc-600 hover:text-zinc-400 cursor-grab active:cursor-grabbing p-2",children:(0,b.jsx)(m.GripVertical,{size:20})}),(0,b.jsxs)(d.default,{href:`/projects/${c.id}/episodes/${a.id}`,className:"flex-1 flex items-center gap-4",children:[(0,b.jsx)("div",{className:"w-10 h-10 rounded-full bg-zinc-900 flex items-center justify-center text-zinc-500 font-bold border border-zinc-800",children:a.order}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-bold text-lg group-hover:text-amber-400 transition-colors",children:a.title}),a.concept?.theme&&(0,b.jsx)("p",{className:"text-sm text-zinc-400 mt-1 line-clamp-1",children:a.concept.theme}),(0,b.jsxs)("p",{className:"text-sm text-zinc-500 mt-1",children:["Last edited: ",new Date(a.lastEdited).toLocaleString()]})]})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[(0,b.jsx)(d.default,{href:`/projects/${c.id}/episodes/${a.id}`,children:(0,b.jsx)(n.Button,{variant:"ghost",size:"sm",className:"text-zinc-400 hover:text-white",children:(0,b.jsx)(k,{size:16})})}),(0,b.jsx)(n.Button,{variant:"ghost",size:"sm",onClick:()=>e(a.id),className:"text-zinc-400 hover:text-red-400",children:(0,b.jsx)(l.Trash2,{size:16})})]})]})}function u({id:a}){let k=(0,e.useRouter)(),{project:m,loading:s,updateProject:u,mutate:v}=(0,o.useProject)(a),[w,x]=(0,c.useState)("episodes"),y=(0,q.useSensors)((0,q.useSensor)(q.PointerSensor),(0,q.useSensor)(q.KeyboardSensor,{coordinateGetter:r.sortableKeyboardCoordinates}));if(s)return(0,b.jsx)("div",{className:"p-8 text-center text-zinc-500",children:"読み込み中..."});if(!m)return(0,b.jsx)("div",{className:"p-8 text-center text-zinc-500",children:"プロジェクトが見つかりません"});let z=m.episodes||[],A=async()=>{let a=crypto.randomUUID(),b=(z.length>0?Math.max(...z.map(a=>a.order)):0)+1,c=[...z,{id:a,projectId:m.id,title:`第${b}話`,order:b,lastEdited:new Date().toISOString()}];v({...m,episodes:c});try{let b=await fetch(`/api/projects/${m.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({episodes:c})});if(!b.ok){let a=await b.json();throw console.error("Server Save Error:",a),Error(a.details||"Failed to save episode")}k.push(`/projects/${m.id}/episodes/${a}`)}catch(a){console.error(a),alert(`エピソードの作成に失敗しました。
${a.message}`)}},B=a=>{confirm("エピソードを削除しますか？")&&u({episodes:z.filter(b=>b.id!==a)})};return(0,b.jsxs)("div",{className:"min-h-screen bg-zinc-950 text-white",children:[(0,b.jsx)("div",{className:"sticky top-0 z-50 bg-zinc-950/80 backdrop-blur-md border-b border-zinc-800",children:(0,b.jsxs)("div",{className:"max-w-6xl mx-auto px-6 h-16 flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)(d.default,{href:"/",className:"text-zinc-500 hover:text-white transition-colors",children:(0,b.jsx)(f.ArrowLeft,{size:20})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"font-bold text-lg",children:m.title}),(0,b.jsx)("p",{className:"text-sm text-zinc-500",children:"シリーズ設定・管理"})]})]}),(0,b.jsx)(p.UserMenu,{})]})}),(0,b.jsxs)("div",{className:"max-w-6xl mx-auto p-6 md:p-10 space-y-10",children:[(0,b.jsxs)("div",{className:"flex gap-8 border-b border-zinc-800",children:[(0,b.jsxs)("button",{onClick:()=>x("episodes"),className:`pb-4 text-sm font-bold flex items-center gap-2 border-b-2 transition-colors ${"episodes"===w?"border-white text-white":"border-transparent text-zinc-500 hover:text-zinc-300"}`,children:[(0,b.jsx)(j.BookOpen,{size:16}),"エピソード一覧"]}),(0,b.jsx)(d.default,{href:`/projects/${a}/characters`,children:(0,b.jsxs)("button",{className:"pb-4 text-sm font-bold flex items-center gap-2 border-b-2 border-transparent text-zinc-500 hover:text-zinc-300 transition-colors",children:[(0,b.jsx)(i.Users,{size:16}),"キャラクター名簿"]})}),(0,b.jsxs)("button",{onClick:()=>x("settings"),className:`pb-4 text-sm font-bold flex items-center gap-2 border-b-2 transition-colors ${"settings"===w?"border-white text-white":"border-transparent text-zinc-500 hover:text-zinc-300"}`,children:[(0,b.jsx)(h.Settings,{size:16}),"作品設定 (World)"]})]}),"episodes"===w&&(0,b.jsxs)("div",{className:"space-y-6 animate-in fade-in slide-in-from-bottom-2",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("h2",{className:"text-xl font-bold",children:"エピソード"}),(0,b.jsxs)(n.Button,{onClick:A,className:"bg-white text-black hover:bg-zinc-200 font-bold rounded-full px-6",children:[(0,b.jsx)(g.Plus,{size:16,className:"mr-2"}),"新しいエピソードを作成"]})]}),(0,b.jsx)("div",{className:"grid grid-cols-1 gap-4",children:0===z.length?(0,b.jsx)("div",{className:"p-10 border border-dashed border-zinc-800 rounded-2xl text-center text-zinc-500",children:"まだエピソードがありません。"}):(0,b.jsx)(q.DndContext,{sensors:y,collisionDetection:q.closestCenter,onDragEnd:a=>{let{active:b,over:c}=a;if(b.id!==c?.id){let a=z.findIndex(a=>a.id===b.id),d=z.findIndex(a=>a.id===c?.id),e=(0,r.arrayMove)(z,a,d).map((a,b)=>({...a,order:b+1}));v({...m,episodes:e}),u({episodes:e})}},children:(0,b.jsx)(r.SortableContext,{items:z.map(a=>a.id),strategy:r.verticalListSortingStrategy,children:z.sort((a,b)=>a.order-b.order).map(a=>(0,b.jsx)(t,{episode:a,project:m,handleDeleteEpisode:B},a.id))})})})]}),"settings"===w&&(0,b.jsxs)("div",{className:"max-w-2xl space-y-8 animate-in fade-in slide-in-from-bottom-2",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm font-bold text-zinc-500 uppercase tracking-wider mb-2 block",children:"作品タイトル"}),(0,b.jsx)("input",{value:m.title,onChange:a=>u({title:a.target.value}),className:"w-full bg-zinc-900 border border-zinc-800 rounded-xl px-4 py-3 text-lg font-bold text-white focus:outline-none focus:border-zinc-600"})]}),(0,b.jsx)("div",{className:"pt-8 border-t border-zinc-800 space-y-8",children:(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-xl font-bold mb-4",children:"世界観の設定項目"}),(0,b.jsx)("p",{className:"text-sm text-zinc-500 mb-6",children:"物語の舞台や背景となる設定を定義します。"}),(0,b.jsxs)("div",{className:"space-y-6",children:[[{key:"era",label:"時代"},{key:"worldView",label:"世界観"},{key:"stage",label:"舞台"},{key:"originalElements",label:"舞台の王道な要素以外に追加したあなたのオリジナル要素"},{key:"gimmicks",label:"（もしある場合は）舞台にしかけられている仕掛け"},{key:"pastIncidents",label:"過去に起きた重要な事件の概要"},{key:"terminology",label:"設定の用語"}].map(a=>(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm font-bold text-zinc-500 uppercase tracking-wider mb-2 block",children:a.label}),(0,b.jsx)("textarea",{value:m.worldStructure?.[a.key]||"",onChange:b=>{u({worldStructure:{...m.worldStructure,[a.key]:b.target.value}})},className:"w-full bg-zinc-900 border border-zinc-800 rounded-xl px-4 py-3 text-zinc-300 focus:outline-none focus:border-zinc-600 min-h-[80px] resize-y"})]},a.key)),(0,b.jsxs)("div",{className:"pt-4 space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("label",{className:"text-sm font-bold text-zinc-500 uppercase tracking-wider block",children:"カスタム設定項目"}),(0,b.jsxs)(n.Button,{variant:"ghost",size:"sm",onClick:()=>{let a=[...m.worldStructure?.customItems||[],{id:crypto.randomUUID(),label:"",value:""}];u({worldStructure:{...m.worldStructure,customItems:a}})},className:"text-zinc-400 hover:text-white",children:[(0,b.jsx)(g.Plus,{size:14,className:"mr-1"})," 追加"]})]}),m.worldStructure?.customItems?.map((a,c)=>(0,b.jsxs)("div",{className:"bg-zinc-900/50 p-4 rounded-xl border border-zinc-800 space-y-3 relative group",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("input",{placeholder:"項目名 (例: 通貨単位)",value:a.label,onChange:b=>{let d=[...m.worldStructure?.customItems||[]];d[c]={...a,label:b.target.value},u({worldStructure:{...m.worldStructure,customItems:d}})},className:"bg-transparent border-b border-zinc-700 focus:border-zinc-500 py-1 text-base font-bold text-zinc-300 w-full focus:outline-none"}),(0,b.jsx)("button",{onClick:()=>{let b=(m.worldStructure?.customItems||[]).filter(b=>b.id!==a.id);u({worldStructure:{...m.worldStructure,customItems:b}})},className:"text-zinc-600 hover:text-red-400 p-1",children:(0,b.jsx)(l.Trash2,{size:14})})]}),(0,b.jsx)("textarea",{placeholder:"内容を入力...",value:a.value,onChange:b=>{let d=[...m.worldStructure?.customItems||[]];d[c]={...a,value:b.target.value},u({worldStructure:{...m.worldStructure,customItems:d}})},className:"w-full bg-zinc-900 border border-zinc-800 rounded-lg px-3 py-2 text-base text-zinc-300 focus:outline-none focus:border-zinc-600 min-h-[60px] resize-y"})]},a.id))]})]})]})}),(0,b.jsx)("div",{className:"pt-8 border-t border-zinc-800 space-y-8",children:(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-xl font-bold mb-4",children:"テーマと物語の構成"}),(0,b.jsx)("p",{className:"text-sm text-zinc-500 mb-6",children:"物語の核となるテーマや、構造的な要素を言語化します。"}),(0,b.jsxs)("div",{className:"space-y-6",children:[[{key:"topic",label:"テーマとなる議題"},{key:"symbol",label:"テーマの象徴となるアイテム"},{key:"interestPoint",label:"このテーマの面白いポイント・興味を持った理由"},{key:"message",label:"主張したいこと・読者に伝えたいこと"},{key:"opposingView",label:"反対となる意見"},{key:"thirdView",label:"第3の意見 (肯定的だが否定的側面も理解)"},{key:"fourthView",label:"第4の意見 (否定的だが肯定的側面も理解)"},{key:"strengths",label:"好きなもの・得意なもの・深い知識"},{key:"concept",label:"物語のコンセプト"},{key:"expression",label:"テーマをどう表現して伝えるか"},{key:"mainProblem",label:"メインストーリーで解決すべきこと"},{key:"subProblem",label:"サポートストーリーで解決すべきこと"},{key:"solution",label:"どうやって解決するのか"},{key:"protagonistChange",label:"物語を通した主人公の変化"},{key:"surroundingChange",label:"周囲のキャラクターの変化"},{key:"readerInterest",label:"読者が興味を持つポイント"},{key:"emotionalPoint",label:"感動する要素"}].map(a=>(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm font-bold text-zinc-500 uppercase tracking-wider mb-2 block",children:a.label}),(0,b.jsx)("textarea",{value:m.themeStructure?.[a.key]||"",onChange:b=>{u({themeStructure:{...m.themeStructure,[a.key]:b.target.value}})},className:"w-full bg-zinc-900 border border-zinc-800 rounded-xl px-4 py-3 text-zinc-300 focus:outline-none focus:border-zinc-600 min-h-[80px] resize-y"})]},a.key)),(0,b.jsxs)("div",{className:"pt-4 space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("label",{className:"text-sm font-bold text-zinc-500 uppercase tracking-wider block",children:"カスタム項目"}),(0,b.jsxs)(n.Button,{variant:"ghost",size:"sm",onClick:()=>{let a=[...m.themeStructure?.customItems||[],{id:crypto.randomUUID(),label:"",value:""}];u({themeStructure:{...m.themeStructure,customItems:a}})},className:"text-zinc-400 hover:text-white",children:[(0,b.jsx)(g.Plus,{size:14,className:"mr-1"})," 追加"]})]}),m.themeStructure?.customItems?.map((a,c)=>(0,b.jsxs)("div",{className:"bg-zinc-900/50 p-4 rounded-xl border border-zinc-800 space-y-3 relative group",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("input",{placeholder:"項目名 (例: 裏テーマ)",value:a.label,onChange:b=>{let d=[...m.themeStructure?.customItems||[]];d[c]={...a,label:b.target.value},u({themeStructure:{...m.themeStructure,customItems:d}})},className:"bg-transparent border-b border-zinc-700 focus:border-zinc-500 py-1 text-base font-bold text-zinc-300 w-full focus:outline-none"}),(0,b.jsx)("button",{onClick:()=>{let b=(m.themeStructure?.customItems||[]).filter(b=>b.id!==a.id);u({themeStructure:{...m.themeStructure,customItems:b}})},className:"text-zinc-600 hover:text-red-400 p-1",children:(0,b.jsx)(l.Trash2,{size:14})})]}),(0,b.jsx)("textarea",{placeholder:"内容を入力...",value:a.value,onChange:b=>{let d=[...m.themeStructure?.customItems||[]];d[c]={...a,value:b.target.value},u({themeStructure:{...m.themeStructure,customItems:d}})},className:"w-full bg-zinc-900 border border-zinc-800 rounded-lg px-3 py-2 text-base text-zinc-300 focus:outline-none focus:border-zinc-600 min-h-[60px] resize-y"})]},a.id))]})]})]})})]})]})]})}a.s(["ProjectPageClient",()=>u],55683)}];

//# sourceMappingURL=src_app_projects_%5Bid%5D_ProjectPageClient_tsx_4083c595._.js.map