module.exports=[36313,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.HooksClientContext},18341,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.ServerInsertedHtml},56704,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},20635,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},9270,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.AppRouterContext},38783,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactServerDOMTurbopackClient},21920,a=>{"use strict";var b=a.i(72131),c=a.i(75003);let d="manga-app-projects-v4-hierarchy",e=[{id:"seed-1",title:"魔法使いの弟子と機械仕掛けの街",description:"魔法が衰退し、科学が発展した世界。",lastEdited:new Date().toISOString(),episodes:[{id:"seed-ep-1",projectId:"seed-1",title:"第1話",order:1,lastEdited:new Date().toISOString(),concept:{theme:"伝統と革新の対立、そして融合",emotions:"ワクワク感、少しの切なさ、希望",keywords:"スチームパンク, 魔法, 師弟関係, 冒険",note:"ビジュアルは錆びついた真鍮と光る魔法陣のコントラスト。"},outline:{start:"魔法が使えず、周囲にバカにされている状態（ゴールの逆）",end:"魔法と科学を融合させ、街の英雄として認められる（ゴール）",midpoint:"師匠がさらわれ、魔法だけでは勝てないと悟る（変化のきっかけ）",decision:"禁忌とされていた「機械との融合」を受け入れ、新しい杖を作る（変化の証明）"},structureBoard:[{id:"c1",act:"1",content:"廃材置き場で古代の杖を拾う",tags:["wakuwaku"],scenes:[{id:"i1",drawing:"",dialogues:[{id:"d1",character:"アルト",text:"これが...伝説の杖？",memo:"驚きの表情"}]},{id:"i2",drawing:"",dialogues:[{id:"d2",character:"（ト書き）",text:"杖が淡く光り始める。",memo:"足元の廃材が揺れる"}]}]},{id:"c2",act:"1",content:"機械兵の襲撃、師匠が捕まる [TP1]",tags:["vs","dokidoki"],scenes:[]},{id:"c3",act:"2",content:"機械技師リナとの出会い",tags:["wakuwaku"],scenes:[]},{id:"c4",act:"2",content:"魔法が通じず敗北 [Midpoint]",tags:["vs","bikkuri"],scenes:[]},{id:"c5",act:"2",content:"リナと協力してハイブリッド杖を開発",tags:["wakuwaku"],scenes:[]},{id:"c6",act:"2",content:"敵のアジトへ潜入 [TP2]",tags:["dokidoki"],scenes:[]},{id:"c7",act:"3",content:"長官との最終決戦",tags:["vs","dokidoki"],scenes:[]},{id:"c8",act:"3",content:"勝利と新しい時代の幕開け",tags:["wakuwaku"],scenes:[]}]}]}];function f(a){let[c,d]=(0,b.useState)(null),[e,f]=(0,b.useState)(!0),[g,h]=(0,b.useState)(null),i=(0,b.useRef)(null);return(0,b.useEffect)(()=>{a&&(async()=>{try{f(!0);let b=await fetch(`/api/projects/${a}`,{cache:"no-store"});if(!b.ok)throw Error("Project not found");let c=await b.json();d(c)}catch(a){h(a.message)}finally{f(!1)}})()},[a]),{project:c,loading:e,error:g,mutate:a=>{d(a)},updateProject:(b,e)=>{if(!c)return;let f={...c,...b,lastEdited:new Date().toISOString()};d(f),i.current&&clearTimeout(i.current),e?.localOnly||(i.current=setTimeout(async()=>{try{await fetch(`/api/projects/${a}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(f)})}catch(a){console.error("Auto-save failed",a)}},1e3))}}}a.s(["useProject",()=>f,"useProjects",0,()=>{let{data:a,status:f}=(0,c.useSession)(),[g,h]=(0,b.useState)([]),[i,j]=(0,b.useState)(!0),k=(0,b.useRef)({});(0,b.useEffect)(()=>{let a=async()=>{j(!0);try{if("authenticated"===f){let a=await fetch("/api/projects");if(a.ok){let b=(await a.json()).map(a=>({...a.data,id:a.id,title:a.title,description:a.description,lastEdited:a.updatedAt}));h(b)}}else if("unauthenticated"===f){let a=localStorage.getItem(d);a?h(JSON.parse(a)):h(e)}}catch(a){console.error("Sync load failed",a)}finally{j(!1)}};"loading"!==f&&a()},[f]);let l=async a=>{let b=crypto.randomUUID(),c={...a,id:b,lastEdited:new Date().toISOString()};if(h(a=>[c,...a]),"authenticated"===f)try{let a=await fetch("/api/projects",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:c.title,description:c.description,data:c})});if(a.ok){let c=await a.json();h(a=>a.map(a=>a.id===b?{...a,id:c.id}:a))}}catch(a){console.error("Cloud create failed",a)}else localStorage.setItem(d,JSON.stringify([c,...g]))},m=async a=>{if(h(b=>{let c=b.filter(b=>b.id!==a);return"authenticated"!==f&&localStorage.setItem(d,JSON.stringify(c)),c}),"authenticated"===f)try{await fetch(`/api/projects/${a}`,{method:"DELETE"})}catch(a){console.error("Cloud delete failed",a)}};return{projects:g,loading:i||"loading"===f,addProject:l,deleteProject:m,updateProject:(a,b,c)=>{h(e=>{let g=e.map(d=>{if(d.id===a){let e={...d,...b,lastEdited:new Date().toISOString()};return"authenticated"!==f||c?.localOnly||(k.current[a]&&clearTimeout(k.current[a]),k.current[a]=setTimeout(async()=>{try{await fetch(`/api/projects/${a}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:e.title,description:e.description,data:e})})}catch(a){console.error("Auto-save failed",a)}},2e3)),e}return d});return"authenticated"!==f&&localStorage.setItem(d,JSON.stringify(g)),g})}}}])},3155,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(38246);let f=(0,a.i(70106).default)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);var g=a.i(96438),h=a.i(21920);function i(){let a=(0,d.useRouter)(),{addProject:i}=(0,h.useProjects)(),[j,k]=(0,c.useState)(""),[l,m]=(0,c.useState)("");return(0,b.jsxs)("div",{className:"min-h-screen bg-zinc-50 dark:bg-zinc-950",children:[(0,b.jsx)("header",{className:"border-b border-zinc-200 bg-white dark:border-zinc-800 dark:bg-zinc-950",children:(0,b.jsx)("div",{className:"container mx-auto px-4 h-16 flex items-center",children:(0,b.jsx)(e.default,{href:"/",children:(0,b.jsxs)(g.Button,{variant:"ghost",size:"sm",className:"gap-2 text-zinc-500",children:[(0,b.jsx)(f,{className:"h-4 w-4"}),"戻る"]})})})}),(0,b.jsxs)("main",{className:"container mx-auto px-4 py-8 max-w-2xl",children:[(0,b.jsxs)("div",{className:"mb-8",children:[(0,b.jsx)("h1",{className:"text-2xl font-bold tracking-tight mb-2",children:"新規プロジェクト作成"}),(0,b.jsx)("p",{className:"text-zinc-500 dark:text-zinc-400",children:"新しい漫画のアイデアを形にしましょう。"})]}),(0,b.jsxs)("form",{onSubmit:b=>{b.preventDefault(),j.trim()&&(i({title:j,description:l,concept:{theme:"",emotions:"",keywords:"",note:""}}),a.push("/"))},className:"space-y-6 bg-white p-6 rounded-xl border border-zinc-200 shadow-sm dark:bg-zinc-950 dark:border-zinc-800",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("label",{htmlFor:"title",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:["タイトル ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)("input",{id:"title",type:"text",value:j,onChange:a=>k(a.target.value),placeholder:"例: 魔法使いの弟子",required:!0,className:"flex h-10 w-full rounded-md border border-zinc-300 bg-transparent px-3 py-2 text-sm placeholder:text-zinc-400 focus:outline-none focus:ring-2 focus:ring-zinc-900 focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 text-zinc-900 dark:border-zinc-800 dark:ring-offset-zinc-950 dark:placeholder:text-zinc-400 dark:text-zinc-50 dark:focus:ring-zinc-300"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{htmlFor:"description",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"あらすじ・メモ"}),(0,b.jsx)("textarea",{id:"description",value:l,onChange:a=>m(a.target.value),placeholder:"物語の概要やアイデアを自由に入力してください...",rows:5,className:"flex w-full rounded-md border border-zinc-300 bg-transparent px-3 py-2 text-sm placeholder:text-zinc-400 focus:outline-none focus:ring-2 focus:ring-zinc-900 focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 text-zinc-900 dark:border-zinc-800 dark:ring-offset-zinc-950 dark:placeholder:text-zinc-400 dark:text-zinc-50 dark:focus:ring-zinc-300 resize-none"})]}),(0,b.jsxs)("div",{className:"pt-4 flex justify-end gap-4",children:[(0,b.jsx)(e.default,{href:"/",children:(0,b.jsx)(g.Button,{type:"button",variant:"ghost",children:"キャンセル"})}),(0,b.jsx)(g.Button,{type:"submit",disabled:!j.trim(),children:"作成する"})]})]})]})]})}a.s(["default",()=>i],3155)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__ac5f0936._.js.map